# Linux 应急响应完整分析报告

**目标服务器**: 154.xx.xx.90  
**排查时间**: 2026-01-20  
**执行人**: Linux Gun AI Assistant  

## 1. 🚨 核心发现与风险评级
*   **整体风险等级**: 🟠 **中高危**
*   **最关键风险**:
    1.  发现外部 IP **222.131.222.186** 建立了 **SSH 隧道 (端口转发)**，行为可疑。
    2.  SSH 配置存在高危项（允许 Root 密码直连），且审计工具缺失（无法查看历史登录）。
    3.  系统内存中发现大量可执行段（已排除误报，确认为 IDE 服务）。

---

## 2. 🔍 详细排查结果

### 2.1 网络与隧道检测 (⚠️ 发现异常)
*   **异常连接**: 发现 IP `222.131.222.186` 与服务器建立了 SSH 连接，并开启了 **本地端口转发**。
    *   **证据**: 进程 PID `779931` (sshd-session) 同时监听了本地端口 `127.0.0.1:11942` 和 `127.0.0.1:11934`。
    *   **分析**: 这通常意味着该用户正在使用 SSH 隧道访问服务器内部服务，或者将服务器作为跳板。
    *   **建议**: **立即确认**该 IP 是否为管理员 IP。如果不是，说明服务器已被作为跳板攻陷。

### 2.2 内存与进程取证 (✅ 已排除误报)
*   **可疑发现**: 进程 PID `744806` 拥有大量 `rwxp` (可读可写可执行) 内存段，这是典型的代码注入或恶意软件特征。
*   **深度研判**:
    *   **命令行**: `/root/.trae-server/bin/.../node ... cueMain.js`
    *   **结论**: 经核实，这是 **Trae IDE Server** 的正常进程（Node.js 的 JIT 编译机制会产生此类内存段）。
    *   **状态**: **安全（误报）**。

### 2.3 病毒与 Webshell 排查 (✅ 未见异常)
*   **Webshell**: 扫描了 `/var/www`, `/home/wwwroot` 等常见目录，未发现 Web 服务目录或 Webshell 文件。
*   **病毒/挖矿**:
    *   CPU 使用率正常，未发现高占用进程。
    *   `/tmp`, `/dev/shm` 等敏感目录未发现可疑可执行文件。
    *   未发现 `xmrig`, `minerd` 等常见挖矿进程。

### 2.4 系统基线与配置 (⚠️ 存在风险)
*   **SSH 安全**:
    *   🔴 `PermitRootLogin yes`: 允许 Root 用户远程直接登录（极易被暴力破解）。
    *   🔴 `PasswordAuthentication yes`: 允许密码认证（建议改为仅密钥认证）。
*   **密码策略**:
    *   🔴 `PASS_MAX_DAYS 99999`: 密码永不过期，不符合安全规范。
*   **审计缺失**:
    *   🔴 系统未安装 `util-linux` 包，导致 `last`, `lastb` 命令无法使用，无法追溯历史登录记录和爆破记录。

### 2.5 后门排查 (✅ 未见异常)
*   **系统后门**: 检查了 `rc.local`, `/etc/init.d/`, `LD_PRELOAD`, `alias`，均未发现异常驻留项。
*   **SSH 后门**: `authorized_keys` 文件为空，排除了未知的 SSH 公钥后门。

---

## 3. 💡 处置与加固建议

### 3.1 紧急确认
*   请立即确认 IP **222.131.222.186** 是否为您或同事的操作。如果不是，请立即阻断该 IP 并强制断开其 SSH 连接：
    ```bash
    kill -9 779931
    iptables -I INPUT -s 222.131.222.186 -j DROP
    ```

### 3.2 系统加固 (高优先级)
*   **修改 SSH 配置** (`/etc/ssh/sshd_config`):
    ```bash
    PermitRootLogin prohibit-password  # 禁止 Root 密码登录 (仅限密钥)
    # 或者创建一个普通用户用于登录，完全禁止 Root 远程登录
    ```
*   **安装审计工具**:
    ```bash
    apt-get update && apt-get install util-linux
    ```

### 3.3 后续监控
*   建议修改 Root 密码，以防凭据泄露。
*   定期查看 `/var/log/auth.log` (安装 util-linux 后使用 `lastb`) 监控异常登录尝试。
